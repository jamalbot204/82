@import "tailwindcss";
@config "./tailwind.config.js";

@layer base {
  /* Original Dark Mode (Deep Space/Aurora) */
  body.theme-dark {
    --aurora-bg: #010103;
    --aurora-surface: rgba(18, 18, 28, 0.55);
    --aurora-surface-hover: rgba(30, 30, 45, 0.65);
    --aurora-border: rgba(255, 255, 255, 0.08);
    --aurora-glow: #5a62f5;
    --aurora-text-primary: #E9E9EB;
    --aurora-text-secondary: #A3A3A8;
    --aurora-accent-primary: #5a62f5;
    --aurora-accent-hover: #787FF6;
    --aurora-accent-secondary: #9c33f5;
    --aurora-accent-danger: #f53333;
    --aurora-code-bg: #0d0d0d;
    --aurora-markdown-red: #ff6b6b;
    --aurora-markdown-blue: #60a5fa;
    --aurora-text-on-accent: #FFFFFF;
    --aurora-text-on-surface: #E9E9EB;
    --aurora-input-bg: rgba(10, 10, 15, 0.55);
    --aurora-input-radius: 1rem;
    --aurora-msg-user-bg: var(--aurora-accent-primary);
    --aurora-msg-ai-bg: rgba(25, 25, 35, 0.55);
  }

  /* Evening Charcoal Mode (Light Mode) */
  body.theme-light {
    --aurora-bg: #212121;
    --aurora-surface: rgba(45, 45, 45, 0.65);
    --aurora-surface-hover: rgba(60, 60, 60, 0.75);
    --aurora-border: rgba(255, 255, 255, 0.08);
    --aurora-glow: #555555;
    --aurora-text-primary: #ECECEC;
    --aurora-text-secondary: #B4B4B4;
    --aurora-accent-primary: #383838;
    --aurora-accent-hover: #484848;
    --aurora-accent-secondary: #9c33f5;
    --aurora-accent-danger: #ef4444;
    --aurora-code-bg: #111111;
    --aurora-markdown-red: #fca5a5;
    --aurora-markdown-blue: #93c5fd;
    --aurora-text-on-accent: #ECECEC;
    --aurora-text-on-surface: #ECECEC;
    --aurora-input-bg: rgba(35, 35, 35, 0.65);
    --aurora-input-radius: 1.5rem;
    --aurora-msg-user-bg: rgba(255, 255, 255, 0.1);
    --aurora-msg-ai-bg: rgba(47, 47, 47, 0.65);
  }

  /* CRITICAL FIX: Apply the background and text color globally */
  html, body {
    height: 100%;
    width: 100%;
    overflow: hidden;
    margin: 0;
    padding: 0;
    position: fixed;
    background-color: var(--aurora-bg);
    color: var(--aurora-text-primary);
    font-family: 'IBM Plex Sans Arabic', 'Inter', sans-serif;
  }

  /* Restore pointer cursor for interactive elements */
  button, 
  [role="button"],
  [type="button"],
  [type="submit"],
  [type="reset"] {
    cursor: pointer;
  }
  
  /* Ensure disabled buttons show the 'not-allowed' cursor */
  button:disabled,
  [role="button"][aria-disabled="true"] {
    cursor: not-allowed;
  }

  /* Preserved Styles */
  :root {
    --aurora-transition: all 0.2s ease-in-out;
    --ease-apple: cubic-bezier(0.25, 1, 0.5, 1);
  }

  body.theme-dark {
    background-image:
      radial-gradient(ellipse at top, rgba(90, 98, 245, 0.08), transparent 50%),
      radial-gradient(ellipse at bottom, rgba(156, 51, 245, 0.06), transparent 60%);
    background-repeat: no-repeat;
    background-size: 200% 200%;
    animation: aurora-background-pan 20s ease-in-out infinite;
  }

  body.theme-light {
    background-image: none;
  }

  @keyframes aurora-background-pan {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }

  body.theme-dark ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 3px; }
  body.theme-dark ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.2); }

  body.theme-light ::-webkit-scrollbar-thumb { background: #4E4E4E; border-radius: 3px; }
  body.theme-light ::-webkit-scrollbar-thumb:hover { background: #666666; }

  html { scrollbar-width: thin; }
  body.theme-dark { scrollbar-color: rgba(255, 255, 255, 0.2) transparent; }
  body.theme-light { scrollbar-color: #4E4E4E transparent; }
}

@layer components {
  .aurora-surface {
    @apply bg-aurora-surface border border-aurora-border backdrop-blur-md transition-all duration-300 shadow-[0_4px_30px_rgba(0,0,0,0.1)];
  }
  
  .aurora-panel {
    @apply bg-aurora-surface border border-aurora-border backdrop-blur-md transition-all duration-300 text-aurora-textPrimary will-change-[transform,opacity] shadow-[0_4px_16px_rgba(0,0,0,0.15)];
  }
  
  .theme-dark .aurora-panel {
    background-color: rgba(18, 18, 28, 0.65);
  }
  
  .theme-light .aurora-panel {
    background-color: rgba(45, 45, 45, 0.65);
    @apply border-aurora-border;
  }
  
  .aurora-input, .aurora-textarea, .aurora-select {
    @apply bg-aurora-inputBg border border-aurora-border text-aurora-textPrimary rounded-md transition-all duration-300 ease-in-out backdrop-blur-md shadow-inner;
  }

  .theme-light .aurora-input, 
  .theme-light .aurora-textarea, 
  .theme-light .aurora-select {
    @apply bg-aurora-inputBg border-aurora-border text-aurora-textPrimary backdrop-blur-md shadow-inner;
  }

  .theme-light ::placeholder {
    @apply text-aurora-textSecondary opacity-70;
  }

  .aurora-input:focus, .aurora-textarea:focus, .aurora-select:focus {
    @apply outline-none border-aurora-accentPrimary ring-2 ring-aurora-border shadow-none;
  }

  /* Markdown specific styles */
  .markdown-content strong { @apply font-semibold text-aurora-markdownBlue; }
  .markdown-content em { @apply italic text-[#4ade80]; }
  .theme-light .markdown-content em { @apply text-[#16a34a]; }
  
  .markdown-content a { @apply text-[#3b82f6] underline border-b-0; }
  .markdown-content a:hover { @apply text-[#60a5fa] underline border-b-0; }

  .quoted-text { @apply text-[#fbbf24]; }
  .theme-light .quoted-text { @apply text-[#d97706]; }

  .markdown-content code {
    @apply break-words whitespace-pre-wrap;
    overflow-wrap: break-word;
  }

  .markdown-content p, .markdown-content li > p, .markdown-content div {
    @apply mb-2 mt-2 break-words whitespace-pre-line;
    overflow-wrap: break-word;
    word-break: normal;
  }

  .markdown-content blockquote {
    @apply border-l-2 border-aurora-accentSecondary pl-4 ml-0 text-aurora-textSecondary italic;
  }

  .markdown-content ul, .markdown-content ol {
    @apply pl-6 mt-2 mb-2 list-outside;
  }
  .markdown-content ul { @apply list-disc; }
  .markdown-content ol { @apply list-decimal; }
  .markdown-content li { @apply mb-1; }

  .markdown-content table {
    @apply w-auto border-collapse mt-4 mb-4 border border-aurora-border;
  }
  .markdown-content th, .markdown-content td {
    @apply border border-aurora-border px-3 py-2 text-left;
  }
  .markdown-content th { @apply bg-aurora-surface font-semibold; }
  .markdown-content hr { @apply border-t border-aurora-border my-4; }
  
  .markdown-content h1, .markdown-content h2, .markdown-content h3 {
    @apply font-semibold mt-4 mb-2 border-b border-aurora-border pb-1;
  }
  .markdown-content h1 { @apply text-2xl; }
  .markdown-content h2 { @apply text-xl; }
  .markdown-content h3 { @apply text-lg text-aurora-markdownRed; }
  
  .highlighted-text {
    @apply bg-[rgba(253,224,71,0.3)] text-[#fde047] px-[0.15em] py-[0.05em] rounded-[0.2em];
  }
  .theme-light .highlighted-text {
    @apply bg-[rgba(255,255,255,0.1)] text-white;
  }

  .hide-scrollbar::-webkit-scrollbar { display: none; }
  .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

  /* Custom range slider */
  input[type=range] {
    @apply appearance-none bg-transparent cursor-pointer w-full;
  }
  input[type=range]:focus {
    @apply outline-none;
  }
  input[type=range]::-webkit-slider-runnable-track {
    @apply w-full h-1 bg-aurora-surface rounded-sm;
  }
  input[type=range]::-webkit-slider-thumb {
    @apply appearance-none h-4 w-4 rounded-full bg-aurora-accentPrimary -mt-[6px] transition-transform duration-200;
  }
  input[type=range]:focus::-webkit-slider-thumb {
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--aurora-accent-primary) 50%, transparent);
  }
  input[type=range]:active::-webkit-slider-thumb {
    @apply scale-125;
  }
  
  .animate-thinking-dots > div {
      animation: thinking-dots-blink 1.4s infinite ease-in-out;
  }
  .animate-thinking-dots > div:nth-child(1) {
      animation-delay: -0.32s;
  }
  .animate-thinking-dots > div:nth-child(2) {
      animation-delay: -0.16s;
  }

  @keyframes thinking-dots-blink {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.4; transform: scale(0.9); }
  }

  .animate-modal-open {
    animation: modalZoom 0.4s var(--ease-apple) forwards;
  }

  .animate-message-enter {
    animation: slideUpFade 0.4s var(--ease-apple) forwards;
  }
}

@layer utilities {
  .gpu-accelerated {
    will-change: transform, opacity;
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px;
  }

  .message-item-root {
    content-visibility: auto;
    contain-intrinsic-size: 0 150px; /* Estimated average message height */
  }
}

@keyframes modalZoom {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes slideUpFade {
  from { opacity: 0; transform: translateY(20px) scale(0.98); filter: blur(4px); }
  to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
}
